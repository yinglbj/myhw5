<!-- Styles -->
<style>
#chartdiv {
  width: 100%;
  height: 500px;
}
</style>

<!-- Resources -->
<script src="https://cdn.amcharts.com/lib/5/index.js"></script>
<script src="https://cdn.amcharts.com/lib/5/xy.js"></script>
<script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>

<!-- Chart code -->
<script>
am5.ready(function() {

// Data
var allData = {
  
  "1956":{  "日本":0, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1957":{  "日本":0, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1958":{  "日本":0, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1959":{  "日本":0, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1960":{  "日本":0, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1961":{  "日本":0, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1962":{  "日本":0, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1963":{  "日本":0, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1964":{  "日本":0, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1965":{  "日本":40424, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1966":{  "日本":56677, "韓國":0, "香港":0, "中國大陸":0, "澳門":0, "越南":0, "泰國":0, "馬來西亞":0, "新加坡":0,  "菲律賓":0,  "印尼":0, "印度":0},
"1967":{  "日本":57403, "韓國":3822,  "香港":0, "中國大陸":0, "澳門":0, "越南":3246,  "泰國":6364,  "馬來西亞":6101,  "新加坡":1741, "菲律賓":11269,  "印尼":0, "印度":770},
"1968":{  "日本":106239,  "韓國":3216,  "香港":0, "中國大陸":0, "澳門":0, "越南":2741,  "泰國":5913,  "馬來西亞":7634,  "新加坡":3710, "菲律賓":12351,  "印尼":0, "印度":656},
"1969":{  "日本":148088,  "韓國":3387,  "香港":0, "中國大陸":0, "澳門":0, "越南":3720,  "泰國":6533,  "馬來西亞":7512,  "新加坡":4064, "菲律賓":11881,  "印尼":0, "印度":541},
"1970":{  "日本":181885,  "韓國":4129,  "香港":0, "中國大陸":0, "澳門":0, "越南":1977,  "泰國":9718,  "馬來西亞":10655, "新加坡":6806, "菲律賓":14767,  "印尼":0, "印度":928},
"1971":{  "日本":263396,  "韓國":5495,  "香港":0, "中國大陸":0, "澳門":0, "越南":1855,  "泰國":8141,  "馬來西亞":8910,  "新加坡":6745, "菲律賓":12517,  "印尼":2531,  "印度":0},
"1972":{  "日本":286439,  "韓國":6744,  "香港":58690, "中國大陸":0, "澳門":0, "越南":3649,  "泰國":10247, "馬來西亞":11680, "新加坡":10951,  "菲律賓":11748,  "印尼":756, "印度":908},
"1973":{  "日本":440875,  "韓國":7334,  "香港":102352,  "中國大陸":0, "澳門":0, "越南":3688,  "泰國":12460, "馬來西亞":19846, "新加坡":17971,  "菲律賓":6257, "印尼":8244,  "印度":1590},
"1974":{  "日本":441201,  "韓國":10478, "香港":95331, "中國大陸":0, "澳門":0, "越南":4471,  "泰國":13540, "馬來西亞":21637, "新加坡":18462,  "菲律賓":7907, "印尼":11903, "印度":1764},
"1975":{  "日本":421125,  "韓國":10200, "香港":105850,  "中國大陸":0, "澳門":0, "越南":12210, "泰國":13356, "馬來西亞":27635, "新加坡":28033,  "菲律賓":7579, "印尼":15649, "印度":2565},
"1976":{  "日本":517909,  "韓國":10816, "香港":132062,  "中國大陸":0, "澳門":0, "越南":4462,  "泰國":14401, "馬來西亞":32726, "新加坡":33255,  "菲律賓":7455, "印尼":20650, "印度":2426},
"1977":{  "日本":565941,  "韓國":12035, "香港":159881,  "中國大陸":0, "澳門":0, "越南":0, "泰國":18121, "馬來西亞":36921, "新加坡":38026,  "菲律賓":11206,  "印尼":26292, "印度":1773},
"1978":{  "日本":633750,  "韓國":22487, "香港":178995,  "中國大陸":0, "澳門":0, "越南":0, "泰國":20916, "馬來西亞":42891, "新加坡":44422,  "菲律賓":21856,  "印尼":34769, "印度":3025},
"1979":{  "日本":706775,  "韓國":27505, "香港":192203,  "中國大陸":0, "澳門":0, "越南":0, "泰國":21950, "馬來西亞":54120, "新加坡":50580,  "菲律賓":23770,  "印尼":31198, "印度":3453},
"1980":{  "日本":667078,  "韓國":29615, "香港":224663,  "中國大陸":0, "澳門":0, "越南":0, "泰國":25952, "馬來西亞":68794, "新加坡":53641,  "菲律賓":26569,  "印尼":37860, "印度":3752},
"1981":{  "日本":603117,  "韓國":31088, "香港":263257,  "中國大陸":0, "澳門":0, "越南":0, "泰國":25827, "馬來西亞":70105, "新加坡":59873,  "菲律賓":30734,  "印尼":40952, "印度":4087},
"1982":{  "日本":579507,  "韓國":41029, "香港":298037,  "中國大陸":0, "澳門":0, "越南":0, "泰國":25760, "馬來西亞":63424, "新加坡":58044,  "菲律賓":29769,  "印尼":36991, "印度":4851},
"1983":{  "日本":598574,  "韓國":39622, "香港":283466,  "中國大陸":0, "澳門":0, "越南":0, "泰國":28811, "馬來西亞":70493, "新加坡":62004,  "菲律賓":28820,  "印尼":32376, "印度":4649},
"1984":{  "日本":636744,  "韓國":36161, "香港":279377,  "中國大陸":0, "澳門":0, "越南":0, "泰國":24015, "馬來西亞":73091, "新加坡":63676,  "菲律賓":25077,  "印尼":29845, "印度":5207},
"1985":{  "日本":619973,  "韓國":36217, "香港":249350,  "中國大陸":0, "澳門":0, "越南":0, "泰國":20017, "馬來西亞":65565, "新加坡":53251,  "菲律賓":27264,  "印尼":27202, "印度":5420},
"1986":{  "日本":694067,  "韓國":34743, "香港":253730,  "中國大陸":0, "澳門":0, "越南":0, "泰國":30872, "馬來西亞":59835, "新加坡":57221,  "菲律賓":29415,  "印尼":28934, "印度":5938},
"1987":{  "日本":796651,  "韓國":44805, "香港":240393,  "中國大陸":0, "澳門":0, "越南":0, "泰國":27631, "馬來西亞":64479, "新加坡":56526,  "菲律賓":35818,  "印尼":26204, "印度":7848},
"1988":{  "日本":911599,  "韓國":91610, "香港":223389,  "中國大陸":0, "澳門":0, "越南":0, "泰國":24029, "馬來西亞":85688, "新加坡":61495,  "菲律賓":38283,  "印尼":26401, "印度":7626},
"1989":{  "日本":964631,  "韓國":138494,  "香港":211804,  "中國大陸":0, "澳門":0, "越南":0, "泰國":21738, "馬來西亞":63017, "新加坡":59833,  "菲律賓":31173,  "印尼":26395, "印度":6509},
"1990":{  "日本":917208,  "韓國":150510,  "香港":193544,  "中國大陸":0, "澳門":0, "越南":0, "泰國":21978, "馬來西亞":49439, "新加坡":59484,  "菲律賓":33665,  "印尼":25848, "印度":5974},
"1991":{  "日本":833624,  "韓國":160861,  "香港":181765,  "中國大陸":0, "澳門":0, "越南":0, "泰國":25124, "馬來西亞":40921, "新加坡":62938,  "菲律賓":32646,  "印尼":23079, "印度":5531},
"1992":{  "日本":789133,  "韓國":157786,  "香港":193523,  "中國大陸":0, "澳門":0, "越南":0, "泰國":34297, "馬來西亞":46783, "新加坡":64532,  "菲律賓":35472,  "印尼":22431, "印度":7028},
"1993":{  "日本":703644,  "韓國":96088, "香港":213953,  "中國大陸":0, "澳門":0, "越南":0, "泰國":90029, "馬來西亞":51265, "新加坡":60796,  "菲律賓":60527,  "印尼":34502, "印度":7507},
"1994":{  "日本":823882,  "韓國":130039,  "香港":241775,  "中國大陸":0, "澳門":0, "越南":0, "泰國":115553,  "馬來西亞":48216, "新加坡":70271,  "菲律賓":76113,  "印尼":39331, "印度":8253},
"1995":{  "日本":914325,  "韓國":146012,  "香港":246747,  "中國大陸":0, "澳門":0, "越南":0, "泰國":147410,  "馬來西亞":54112, "新加坡":70564,  "菲律賓":96336,  "印尼":46486, "印度":9623},
"1996":{  "日本":917890,  "韓國":126915,  "香港":262585,  "中國大陸":0, "澳門":0, "越南":0, "泰國":120764,  "馬來西亞":55730, "新加坡":78419,  "菲律賓":111782, "印尼":50925, "印度":10361},
"1997":{  "日本":905527,  "韓國":99236, "香港":259664,  "中國大陸":0, "澳門":0, "越南":0, "泰國":122114,  "馬來西亞":54401, "新加坡":81831,  "菲律賓":119665, "印尼":54570, "印度":11507},
"1998":{  "日本":826632,  "韓國":63099, "香港":279905,  "中國大陸":0, "澳門":0, "越南":0, "泰國":128541,  "馬來西亞":49291, "新加坡":87022,  "菲律賓":126282, "印尼":47967, "印度":11717},
"1999":{  "日本":826222,  "韓國":76142, "香港":319814,  "中國大陸":0, "澳門":0, "越南":0, "泰國":137972,  "馬來西亞":52678, "新加坡":85844,  "菲律賓":123000, "印尼":76919, "印度":11556},
"2000":{  "日本":916301,  "韓國":83729, "香港":361308,  "中國大陸":0, "澳門":0, "越南":0, "泰國":133185,  "馬來西亞":58017, "新加坡":94897,  "菲律賓":84088,  "印尼":107332,  "印度":13233},
"2001":{  "日本":976750,  "韓國":85744, "香港":435164,  "中國大陸":0, "澳門":0, "越南":0, "泰國":118453,  "馬來西亞":57615, "新加坡":98771,  "菲律賓":74028,  "印尼":89921, "印度":13106},
"2002":{  "日本":998497,  "韓國":83624, "香港":456554,  "中國大陸":0, "澳門":0, "越南":0, "泰國":110650,  "馬來西亞":66304, "新加坡":111024, "菲律賓":79261,  "印尼":87728, "印度":13999},
"2003":{  "日本":657053,  "韓國":92893, "香港":323178,  "中國大陸":0, "澳門":0, "越南":0, "泰國":98390, "馬來西亞":67014, "新加坡":78739,  "菲律賓":80026,  "印尼":38078, "印度":12464},
"2004":{  "日本":887311,  "韓國":148095,  "香港":417087,  "中國大陸":0, "澳門":0, "越南":0, "泰國":103089,  "馬來西亞":92760, "新加坡":116885, "菲律賓":87005,  "印尼":44161, "印度":16305},
"2005":{  "日本":1124334, "韓國":182517,  "香港":432718,  "中國大陸":0, "澳門":0, "越南":0, "泰國":93568, "馬來西亞":107549,  "新加坡":166179, "菲律賓":92074,  "印尼":88464, "印度":17512},
"2006":{  "日本":1161489, "韓國":196260,  "香港":431884,  "中國大陸":0, "澳門":0, "越南":0, "泰國":95643, "馬來西亞":115202,  "新加坡":184160, "菲律賓":79993,  "印尼":90870, "印度":18047},
"2007":{  "日本":1166380, "韓國":225814,  "香港":491437,  "中國大陸":0, "澳門":0, "越南":0, "泰國":90069, "馬來西亞":141308,  "新加坡":204494, "菲律賓":85030,  "印尼":95572, "印度":19976},
"2008":{  "日本":1086691, "韓國":252266,  "香港":584959,  "中國大陸":329204,  "澳門":33708, "越南":76786, "泰國":84586, "馬來西亞":155783,  "新加坡":205449, "菲律賓":87936,  "印尼":110420,  "印度":19976},
"2009":{  "日本":1000661, "韓國":167641,  "香港":677059,  "中國大陸":972123,  "澳門":41747, "越南":60476, "泰國":78405, "馬來西亞":166987,  "新加坡":194523, "菲律賓":77206,  "印尼":106612,  "印度":18555},
"2010":{  "日本":1080153, "韓國":216901,  "香港":744878,  "中國大陸":1630735, "澳門":49484, "越南":72352, "泰國":92949, "馬來西亞":285734,  "新加坡":241334, "菲律賓":87944,  "印尼":123834,  "印度":23849},
"2011":{  "日本":1294758, "韓國":242902,  "香港":764033,  "中國大陸":1784185, "澳門":53911, "越南":95837, "泰國":102902,  "馬來西亞":307898,  "新加坡":299599, "菲律賓":101539, "印尼":156281,  "印度":23927},
"2012":{  "日本":1432315, "韓國":259089,  "香港":949654,  "中國大陸":2586428, "澳門":66702, "越南":89354, "泰國":97712, "馬來西亞":341032,  "新加坡":327253, "菲律賓":105130, "印尼":163598,  "印度":23251},
"2013":{  "日本":1421550, "韓國":351301,  "香港":1105223, "中國大陸":2874702, "澳門":78118, "越南":118467,  "泰國":104138,  "馬來西亞":394326,  "新加坡":364733, "菲律賓":99698,  "印尼":171299,  "印度":23318},
"2014":{  "日本":1634790, "韓國":527684,  "香港":1276039, "中國大陸":3987152, "澳門":99731, "越南":137177,  "泰國":104812,  "馬來西亞":439240,  "新加坡":376235, "菲律賓":136978, "印尼":182704,  "印度":30168},
"2015":{  "日本":1627229, "韓國":658757,  "香港":1389529, "中國大陸":4184102, "澳門":124068,  "越南":146380,  "泰國":124409,  "馬來西亞":431481,  "新加坡":393037, "菲律賓":139217, "印尼":177743,  "印度":32198},
"2016":{  "日本":1895702, "韓國":884397,  "香港":1474521, "中國大陸":3511734, "澳門":140282,  "越南":196636,  "泰國":195640,  "馬來西亞":474420,  "新加坡":407267, "菲律賓":172475, "印尼":188720,  "印度":33550},
"2017":{  "日本":1898854, "韓國":1054708, "香港":1540765, "中國大陸":2732549, "澳門":151298,  "越南":383329,  "泰國":292534,  "馬來西亞":528019,  "新加坡":425577, "菲律賓":290784, "印尼":189631,  "印度":34962},
"2018":{  "日本":1969151, "韓國":1019441, "香港":1506536, "中國大陸":2695615, "澳門":147118,  "越南":490774,  "泰國":320008,  "馬來西亞":526129,  "新加坡":427222, "菲律賓":419105, "印尼":210985,  "印度":38385},
"2019":{  "日本":2167952, "韓國":1242598, "香港":1598223, "中國大陸":2714065, "澳門":159783,  "越南":405396,  "泰國":413926,  "馬來西亞":537692,  "新加坡":460635, "菲律賓":509519, "印尼":229960,  "印度":40353},
"2020":{  "日本":269659,  "韓國":178911,  "香港":162318,  "中國大陸":111050,  "澳門":15336, "越南":110882,  "泰國":63553, "馬來西亞":72705, "新加坡":49946,  "菲律賓":77065,  "印尼":55717, "印度":6606},
"2021":{  "日本":10056, "韓國":3300,  "香港":9594,  "中國大陸":13267, "澳門":1166,  "越南":24935, "泰國":7570,  "馬來西亞":6205,  "新加坡":2417, "菲律賓":9183, "印尼":13819, "印度":1930},
"2022":{  "日本":87616, "韓國":51748, "香港":31009, "中國大陸":24378, "澳門":1612,  "越南":134818,  "泰國":74434, "馬來西亞":59035, "新加坡":69507,  "菲律賓":64038,  "印尼":78162, "印度":9390},
"2023":{  "日本":928235,  "韓國":744727,  "香港":1104519, "中國大陸":226269,  "澳門":95053, "越南":382529,  "泰國":394688,  "馬來西亞":437491,  "新加坡":463893, "菲律賓":350487, "印尼":201980,  "印度":31584},
"2024":{  "日本":1319592, "韓國":1003086, "香港":1198217, "中國大陸":438212,  "澳門":112760,  "越南":370548,  "泰國":400038,  "馬來西亞":429727,  "新加坡":447841, "菲律賓":467157, "印尼":224477,  "印度":38158},

};


// Create root element
// https://www.amcharts.com/docs/v5/getting-started/#Root_element
var root = am5.Root.new("chartdiv");

root.numberFormatter.setAll({
  numberFormat: "#a",

  // Group only into M (millions), and B (billions)
  bigNumberPrefixes: [
    { number: 1e6, suffix: "M" },
    { number: 1e9, suffix: "B" }
  ],

  // Do not use small number prefixes at all
  smallNumberPrefixes: []
});

var stepDuration = 2000;


// Set themes
// https://www.amcharts.com/docs/v5/concepts/themes/
root.setThemes([am5themes_Animated.new(root)]);


// Create chart
// https://www.amcharts.com/docs/v5/charts/xy-chart/
var chart = root.container.children.push(am5xy.XYChart.new(root, {
  panX: true,
  panY: true,
  wheelX: "none",
  wheelY: "none",
  paddingLeft: 0
}));


// We don't want zoom-out button to appear while animating, so we hide it at all
chart.zoomOutButton.set("forceHidden", true);


// Create axes
// https://www.amcharts.com/docs/v5/charts/xy-chart/axes/
var yRenderer = am5xy.AxisRendererY.new(root, {
  minGridDistance: 20,
  inversed: true,
  minorGridEnabled: true
});
// hide grid
yRenderer.grid.template.set("visible", false);

var yAxis = chart.yAxes.push(am5xy.CategoryAxis.new(root, {
  maxDeviation: 0,
  categoryField: "network",
  renderer: yRenderer
}));

var xAxis = chart.xAxes.push(am5xy.ValueAxis.new(root, {
  maxDeviation: 0,
  min: 0,
  strictMinMax: true,
  extraMax: 0.1,
  renderer: am5xy.AxisRendererX.new(root, {})
}));

xAxis.set("interpolationDuration", stepDuration / 10);
xAxis.set("interpolationEasing", am5.ease.linear);


// Add series
// https://www.amcharts.com/docs/v5/charts/xy-chart/series/
var series = chart.series.push(am5xy.ColumnSeries.new(root, {
  xAxis: xAxis,
  yAxis: yAxis,
  valueXField: "value",
  categoryYField: "network"
}));

// Rounded corners for columns
series.columns.template.setAll({ cornerRadiusBR: 5, cornerRadiusTR: 5 });

// Make each column to be of a different color
series.columns.template.adapters.add("fill", function (fill, target) {
  return chart.get("colors").getIndex(series.columns.indexOf(target));
});

series.columns.template.adapters.add("stroke", function (stroke, target) {
  return chart.get("colors").getIndex(series.columns.indexOf(target));
});

// Add label bullet
series.bullets.push(function () {
  return am5.Bullet.new(root, {
    locationX: 1,
    sprite: am5.Label.new(root, {
      text: "{valueXWorking.formatNumber('#.# a')}",
      fill: root.interfaceColors.get("alternativeText"),
      centerX: am5.p100,
      centerY: am5.p50,
      populateText: true
    })
  });
});

var label = chart.plotContainer.children.push(am5.Label.new(root, {
  text: "2002",
  fontSize: "8em",
  opacity: 0.2,
  x: am5.p100,
  y: am5.p100,
  centerY: am5.p100,
  centerX: am5.p100
}));

// Get series item by category
function getSeriesItem(category) {
  for (var i = 0; i < series.dataItems.length; i++) {
    var dataItem = series.dataItems[i];
    if (dataItem.get("categoryY") == category) {
      return dataItem;
    }
  }
}

// Axis sorting
function sortCategoryAxis() {
  // sort by value
  series.dataItems.sort(function (x, y) {
    return y.get("valueX") - x.get("valueX"); // descending
    //return x.get("valueX") - y.get("valueX"); // ascending
  });

  // go through each axis item
  am5.array.each(yAxis.dataItems, function (dataItem) {
    // get corresponding series item
    var seriesDataItem = getSeriesItem(dataItem.get("category"));

    if (seriesDataItem) {
      // get index of series data item
      var index = series.dataItems.indexOf(seriesDataItem);
      // calculate delta position
      var deltaPosition =
        (index - dataItem.get("index", 0)) / series.dataItems.length;
      // set index to be the same as series data item index
      if (dataItem.get("index") != index) {
        dataItem.set("index", index);
        // set deltaPosition instanlty
        dataItem.set("deltaPosition", -deltaPosition);
        // animate delta position to 0
        dataItem.animate({
          key: "deltaPosition",
          to: 0,
          duration: stepDuration / 2,
          easing: am5.ease.out(am5.ease.cubic)
        });
      }
    }
  });
  // sort axis items by index.
  // This changes the order instantly, but as deltaPosition is set, they keep in the same places and then animate to true positions.
  yAxis.dataItems.sort(function (x, y) {
    return x.get("index") - y.get("index");
  });
}

var year = 1966;

// update data with values each 1.5 sec
var interval = setInterval(function () {
  year++;

  if (year > 2024) {
    clearInterval(interval);
    clearInterval(sortInterval);
  }

  updateData();
}, stepDuration);

var sortInterval = setInterval(function () {
  sortCategoryAxis();
}, 100);

function setInitialData() {
  var d = allData[year];

  for (var n in d) {
    series.data.push({ network: n, value: d[n] });
    yAxis.data.push({ network: n });
  }
}

function updateData() {
  var itemsWithNonZero = 0;

  if (allData[year]) {
    label.set("text", year.toString());

    am5.array.each(series.dataItems, function (dataItem) {
      var category = dataItem.get("categoryY");
      var value = allData[year][category];

      if (value > 0) {
        itemsWithNonZero++;
      }

      dataItem.animate({
        key: "valueX",
        to: value,
        duration: stepDuration,
        easing: am5.ease.linear
      });
      dataItem.animate({
        key: "valueXWorking",
        to: value,
        duration: stepDuration,
        easing: am5.ease.linear
      });
    });

    yAxis.zoom(0, itemsWithNonZero / yAxis.dataItems.length);
  }
}

setInitialData();
setTimeout(function () {
  year++;
  updateData();
}, 50);

// Make stuff animate on load
// https://www.amcharts.com/docs/v5/concepts/animations/
series.appear(1000);
chart.appear(1000, 100);

}); // end am5.ready()
</script>

<!-- HTML -->
<div id="chartdiv"></div>